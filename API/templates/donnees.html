<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Votre Page</title>
    <!-- ... -->
    <script>
      const URL_API = "http://127.0.0.1:5000/donnees";
      const ID_LISTE_DONNEE = "data-list";
      let donnees = {}; // Initialiser avec une valeur par défaut

      function afficherDonnees(data) {
        const dataList = data.data;
        let listHTML = "<ul>";
        for (const data of dataList) {
          const id = data[0];
          const va_Temperature = data[1] + " °C";
          const va_Humidite = data[2] + " %";
          const va_Pression = data[3] + " Pa";

          listHTML += `<li>ID: ${id}, Température: ${va_Temperature}, Humidité: ${va_Humidite}, Pression: ${va_Pression}</li>`;
        }
        listHTML += "</ul>";

        const dataListElement = document.getElementById(ID_LISTE_DONNEE);
        dataListElement.innerHTML = listHTML;
      }

      function filtrerDonnees(data, filtre) {
        const filteredData = [];
        for (const dataItem of data) {
          if (filtre(dataItem)) {
            filteredData.push(dataItem);
          }
        }
        return filteredData;
      }

      function trierDonnees(data, critere) {
        const sortedData = data.sort(critere);
        return sortedData;
      }

      document.addEventListener("DOMContentLoaded", function () {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", URL_API);
        xhr.responseType = "json";
        xhr.onload = () => {
          if (xhr.readyState == 4 && xhr.status == 200) {
            donnees = xhr.response;
            afficherDonnees(donnees);
          }
        };
        xhr.send();
      });

      // Filtre les données en fonction de la température
      const filtreTemperature = (data) => {
        return data[1] > 20;
      };

      // Trie les données par température
      const trierParTemperature = (a, b) => {
        return a[1] - b[1];
      };

      // Bouton de filtre
      document.addEventListener("DOMContentLoaded", function () {
        const filtreTemperatureButton =
          document.getElementById("filter-temperature");
        console.log(filtreTemperatureButton); // Ajout de cette ligne
        filtreTemperatureButton.addEventListener("click", function () {
          const filteredData = filtrerDonnees(donnees.data, filtreTemperature);
          afficherDonnees({ data: filteredData });
        });

        // Bouton de tri
        const triParTemperatureButton =
          document.getElementById("tri-temperature");
        console.log(triParTemperatureButton); // Ajout de cette ligne
        triParTemperatureButton.addEventListener("click", function () {
          const sortedData = trierDonnees(donnees.data, trierParTemperature);
          afficherDonnees({ data: sortedData });
        });
      });
    </script>
    <!-- ... -->
  </head>
  <body>
    <div id="data-list"></div>

    <button id="filter-temperature">Filtrer par température au dessus de 20°C</button>
    <button id="tri-temperature">Trier par température</button>
  </body>
</html>
