<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Données</title>
</head>
<body>

    <h1>Choisissez le type de données :</h1>

    <!-- Formulaire ajusté avec la méthode POST -->
    <form id="dataForm">
        <button type="button" onclick="fetchData()">Afficher toutes les données</button>
    </form>
    
    <!-- Script JavaScript pour récupérer les données -->
    <script>
        function fetchData() {
            fetch('/donnees', {
                method: 'GET',
            })
            .then(response => response.json())
            .then(data => {
                displayData(data, 'All Data');
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
        

        function displayData(data, dataType) {
            var container = document.getElementById("dataContainer");
            container.innerHTML = '';

            if (data && data.length > 0) {
                var heading = document.createElement("h2");
                heading.textContent = "Les 10 dernières données de " + dataType + " :";
                container.appendChild(heading);

                var table = document.createElement("table");
                var thead = document.createElement("thead");
                var tbody = document.createElement("tbody");

                var headerRow = document.createElement("tr");
                var dateHeader = document.createElement("th");
                dateHeader.textContent = "Date de mesure";
                var valueHeader = document.createElement("th");
                valueHeader.textContent = dataType;

                headerRow.appendChild(dateHeader);
                headerRow.appendChild(valueHeader);

                thead.appendChild(headerRow);

                data.forEach(row => {
                    var dataRow = document.createElement("tr");
                    var dateCell = document.createElement("td");
                    dateCell.textContent = row.Date_mesure;
                    var valueCell = document.createElement("td");
                    valueCell.textContent = row[dataType];

                    dataRow.appendChild(dateCell);
                    dataRow.appendChild(valueCell);

                    tbody.appendChild(dataRow);
                });

                table.appendChild(thead);
                table.appendChild(tbody);
                container.appendChild(table);
            }
        }
    </script>

</body>
</html>
